{
  "$schema": "https://raw.githubusercontent.com/martinring/tmlanguage/master/tmlanguage.json",
  "name": "Elvish",
  "scopeName": "source.elvish",
  "fileTypes": ["elv"],
  "patterns": [
    { "include": "#comment" },
    { "include": "#string-double" },
    { "include": "#string-single" },
    { "include": "#constant" },
    { "include": "#number" },
    { "include": "#keyword" },
    { "include": "#builtin-function" },
    { "include": "#variable" },
    { "include": "#operator" },
    { "include": "#punctuation" }
  ],
  "repository": {
    "comment": {
      "name": "comment.line.number-sign.elvish",
      "match": "#.*$"
    },
    "string-double": {
      "name": "string.quoted.double.elvish",
      "begin": "\"",
      "end": "\"",
      "patterns": [
        {
          "name": "constant.character.escape.elvish",
          "match": "\\\\(?:[abtnvfre\"\\\\]|x[0-9A-Fa-f]{2}|[0-7]{1,3}|u[0-9A-Fa-f]{4}|U[0-9A-Fa-f]{8}|\\^[A-Za-z@\\[\\]\\\\\\^_?]|c[A-Za-z@\\[\\]\\\\\\^_?])"
        },
        { "include": "#variable" }
      ]
    },
    "string-single": {
      "name": "string.quoted.single.elvish",
      "begin": "'",
      "end": "'",
      "patterns": [
        {
          "name": "constant.character.escape.elvish",
          "match": "''"
        }
      ]
    },
    "constant": {
      "patterns": [
        {
          "name": "constant.language.elvish",
          "match": "\\$(true|false|nil|ok|nop)\\b"
        }
      ]
    },
    "number": {
      "patterns": [
        {
          "name": "constant.numeric.float.special.elvish",
          "match": "(?<![\\w$])([+-]?Inf|NaN)(?![\\w])"
        },
        {
          "name": "constant.numeric.hex.elvish",
          "match": "(?<![\\w$])0x[0-9A-Fa-f]+(?![\\w])"
        },
        {
          "name": "constant.numeric.octal.elvish",
          "match": "(?<![\\w$])0o[0-7]+(?![\\w])"
        },
        {
          "name": "constant.numeric.binary.elvish",
          "match": "(?<![\\w$])0b[01]+(?![\\w])"
        },
        {
          "name": "constant.numeric.rational.elvish",
          "match": "(?<![\\w$])[+-]?[0-9]+/[0-9]+(?![\\w])"
        },
        {
          "name": "constant.numeric.float.elvish",
          "match": "(?<![\\w$])[+-]?[0-9]+(?:\\.[0-9]+)?(?:[eE][+-]?[0-9]+)?(?![\\w])"
        }
      ]
    },
    "keyword": {
      "patterns": [
        {
          "name": "keyword.control.elvish",
          "match": "\\b(if|elif|else|while|for|try|catch|finally|break|continue|return)\\b"
        },
        {
          "name": "keyword.other.elvish",
          "match": "\\b(fn|var|set|tmp|del|and|or|coalesce|pragma|use|with)\\b"
        }
      ]
    },
    "builtin-function": {
      "name": "support.function.builtin.elvish",
      "match": "\\b(all|assoc|base|benchmark|bool|call|cd|compact|compare|conj|constantly|count|defer|deprecate|derender-styledown|dissoc|drop|each|echo|eq|eval|exact-num|exec|exit|external|fail|from-json|from-lines|from-terminated|get-env|has-env|has-external|has-key|has-value|inexact-num|is|keep-if|keys|kind-of|make-map|nop|not|not-eq|ns|num|one|only-bytes|only-values|order|peach|pprint|print|printf|put|rand|randint|range|read-bytes|read-line|read-upto|render-styledown|repeat|repr|resolve|run-parallel|search-external|set-env|show|sleep|slurp|src|styled|styled-segment|take|tilde-abbr|time|to-json|to-lines|to-string|to-terminated|unset-env|use-mod|wcswidth)\\b"
    },
    "variable": {
      "patterns": [
        {
          "name": "variable.other.explode.elvish",
          "match": "\\$@[a-zA-Z_][a-zA-Z0-9_~:-]*"
        },
        {
          "name": "variable.other.elvish",
          "match": "\\$[a-zA-Z_][a-zA-Z0-9_~:-]*"
        },
        {
          "name": "variable.other.special.elvish",
          "match": "\\$(?:\"[^\"]*\"|'[^']*')"
        }
      ]
    },
    "operator": {
      "patterns": [
        {
          "name": "keyword.operator.comparison.elvish",
          "match": "==s?|!=s?|<=s?|>=s?|<s|>s|<(?![<>])|>(?![<>])"
        },
        {
          "name": "keyword.operator.arithmetic.elvish",
          "match": "[+\\-*/%]"
        },
        {
          "name": "keyword.operator.pipe.elvish",
          "match": "\\|"
        },
        {
          "name": "keyword.operator.range.elvish",
          "match": "\\.\\.=?"
        },
        {
          "name": "keyword.operator.redirection.elvish",
          "match": ">>|<>|>&|<|>"
        }
      ]
    },
    "punctuation": {
      "patterns": [
        {
          "name": "punctuation.definition.list.begin.elvish",
          "match": "\\["
        },
        {
          "name": "punctuation.definition.list.end.elvish",
          "match": "\\]"
        },
        {
          "name": "punctuation.definition.block.begin.elvish",
          "match": "\\{"
        },
        {
          "name": "punctuation.definition.block.end.elvish",
          "match": "\\}"
        },
        {
          "name": "punctuation.definition.group.begin.elvish",
          "match": "\\("
        },
        {
          "name": "punctuation.definition.group.end.elvish",
          "match": "\\)"
        },
        {
          "name": "punctuation.separator.elvish",
          "match": ";"
        },
        {
          "name": "punctuation.definition.map-key.elvish",
          "match": "&"
        }
      ]
    }
  }
}
