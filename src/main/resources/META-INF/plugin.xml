<idea-plugin>
    <id>com.elvish.plugin</id>
    <name>Elvish</name>
    <vendor email="lorenzo@wynberg.dev" url="https://github.com/LorenzoWynberg/intellij-elvish">Lorenzo Wynberg</vendor>

    <description><![CDATA[
    <p>Full-featured <a href="https://elv.sh">Elvish shell</a> language support for all JetBrains IDEs.</p>

    <h3>Features</h3>
    <ul>
        <li><strong>Syntax Highlighting</strong> - Full TextMate grammar support with colors for keywords, strings, variables, operators, and more</li>
        <li><strong>Code Completion</strong> - Smart completions for built-in functions, variables, and module functions</li>
        <li><strong>Error Diagnostics</strong> - Real-time syntax error detection and highlighting</li>
        <li><strong>Hover Documentation</strong> - View documentation for functions and variables on hover</li>
        <li><strong>Go to Definition</strong> - Navigate to function and variable definitions</li>
        <li><strong>File Type Recognition</strong> - Automatic recognition of .elv files with custom icon</li>
    </ul>

    <h3>Powered by Elvish LSP</h3>
    <p>This plugin uses Elvish's built-in Language Server Protocol (<code>elvish -lsp</code>) to provide intelligent code assistance. The LSP server starts automatically when you open an Elvish file.</p>

    <h3>Requirements</h3>
    <ul>
        <li><strong>Elvish 0.18.0 or later</strong> - <a href="https://elv.sh/get/">Install Elvish</a></li>
        <li><strong>JetBrains IDE 2024.3 or later</strong> - Any IDE (IntelliJ IDEA, WebStorm, PyCharm, etc.)</li>
    </ul>

    <h3>Configuration</h3>
    <p>Configure the Elvish binary path in <em>Settings/Preferences &gt; Languages &amp; Frameworks &gt; Elvish</em></p>

    <h3>Getting Started</h3>
    <ol>
        <li>Install <a href="https://elv.sh/get/">Elvish</a> on your system</li>
        <li>Open any <code>.elv</code> file in your JetBrains IDE</li>
        <li>Start coding with full language support!</li>
    </ol>

    <p><strong>Open Source:</strong> <a href="https://github.com/LorenzoWynberg/intellij-elvish">GitHub Repository</a></p>
    ]]></description>

    <depends>com.intellij.modules.platform</depends>
    <depends>org.jetbrains.plugins.textmate</depends>

    <!-- LSP support - use ultimate module for 2024.x, lsp module for 2025.2+ -->
    <depends optional="true" config-file="lsp-support.xml">com.intellij.modules.ultimate</depends>

    <extensions defaultExtensionNs="com.intellij">
        <fileType
                name="Elvish"
                implementationClass="com.elvish.plugin.ElvishFileType"
                fieldName="INSTANCE"
                language="Elvish"
                extensions="elv"/>

        <lang.parserDefinition
                language="Elvish"
                implementationClass="com.elvish.plugin.parser.ElvishParserDefinition"/>

        <lang.syntaxHighlighterFactory
                language="Elvish"
                implementationClass="com.elvish.plugin.highlighting.ElvishSyntaxHighlighterFactory"/>

        <projectConfigurable
                parentId="language"
                instance="com.elvish.plugin.settings.ElvishConfigurable"
                id="com.elvish.plugin.settings"
                displayName="Elvish"/>

        <lang.commenter
                language="Elvish"
                implementationClass="com.elvish.plugin.editor.ElvishCommenter"/>

        <lang.braceMatcher
                language="Elvish"
                implementationClass="com.elvish.plugin.editor.ElvishBraceMatcher"/>

        <lang.foldingBuilder
                language="Elvish"
                implementationClass="com.elvish.plugin.editor.ElvishFoldingBuilder"/>

        <lang.psiStructureViewFactory
                language="Elvish"
                implementationClass="com.elvish.plugin.editor.structure.ElvishStructureViewFactory"/>

        <breadcrumbsInfoProvider
                implementation="com.elvish.plugin.editor.ElvishBreadcrumbsProvider"/>

        <notificationGroup id="Elvish Plugin"
                           displayType="BALLOON"/>

        <configurationType
                implementation="com.elvish.plugin.run.ElvishConfigurationType"/>

        <runLineMarkerContributor
                language="Elvish"
                implementationClass="com.elvish.plugin.run.ElvishRunLineMarkerProvider"/>

        <runConfigurationProducer
                implementation="com.elvish.plugin.run.ElvishRunConfigurationProducer"/>

        <internalFileTemplate name="Elvish Script"/>
        <internalFileTemplate name="Elvish Module"/>

        <liveTemplateContext
                contextId="ELVISH"
                implementation="com.elvish.plugin.templates.ElvishTemplateContextType"/>

        <defaultLiveTemplates file="/liveTemplates/Elvish.xml"/>

        <indexPatternBuilder
                implementation="com.elvish.plugin.editor.ElvishIndexPatternBuilder"/>
    </extensions>

    <actions>
        <action id="Elvish.NewElvishScript"
                class="com.elvish.plugin.actions.CreateElvishFileAction"
                text="Elvish Script"
                description="Create a new Elvish shell script">
            <add-to-group group-id="NewGroup" anchor="before" relative-to-action="NewFromTemplate"/>
        </action>
    </actions>

    <extensions defaultExtensionNs="org.jetbrains.plugins.textmate">
        <bundleProvider implementation="com.elvish.plugin.textmate.ElvishTextMateBundleProvider"/>
    </extensions>
</idea-plugin>
